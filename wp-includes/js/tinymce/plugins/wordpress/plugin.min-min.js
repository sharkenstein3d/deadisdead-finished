!function(e){e.ui.FloatPanel.zIndex=100100,e.PluginManager.add("wordpress",function(t){function n(n){var o,a,d,l=0;a="hide"===n,t.theme.panel&&(d=t.theme.panel.find(".toolbar:not(.menubar)")),!d||d.length<2||"hide"===n&&!d[1].visible()||(!n&&d[1].visible()&&(n="hide"),s(d,function(e,t){t>0&&("hide"===n?(e.hide(),l+=30):(e.show(),l-=30))}),l&&!a&&(e.Env.iOS||(o=t.getContentAreaContainer().firstChild,r.setStyle(o,"height",o.clientHeight+l)),"hide"===n?(setUserSetting("hidetb","0"),i&&i.active(!1)):(setUserSetting("hidetb","1"),i&&i.active(!0))),t.fire("wp-toolbar-toggle"))}function o(){}var i,a,r=e.DOM,s=e.each,d=t.editorManager.i18n.translate,l=window.jQuery,c=window.wp,p=c&&c.editor&&c.editor.autop&&t.getParam("wpautop",!0);return l&&l(document).triggerHandler("tinymce-editor-setup",[t]),t.addButton("wp_adv",{tooltip:"Toolbar Toggle",cmd:"WP_Adv",onPostRender:function(){i=this,i.active("1"===getUserSetting("hidetb"))}}),t.on("PostRender",function(){t.getParam("wordpress_adv_hidden",!0)&&"0"===getUserSetting("hidetb","0")&&n("hide")}),t.addCommand("WP_Adv",function(){n()}),t.on("focus",function(){window.wpActiveEditor=t.id}),t.on("BeforeSetContent",function(t){var n;t.content&&(-1!==t.content.indexOf("<!--more")&&(n=d("Read more..."),t.content=t.content.replace(/<!--more(.*?)-->/g,function(t,o){return'<img src="'+e.Env.transparentSrc+'" data-wp-more="more" data-wp-more-text="'+o+'" class="wp-more-tag mce-wp-more" alt="" title="'+n+'" data-mce-resize="false" data-mce-placeholder="1" />'})),-1!==t.content.indexOf("<!--nextpage-->")&&(n=d("Page break"),t.content=t.content.replace(/<!--nextpage-->/g,'<img src="'+e.Env.transparentSrc+'" data-wp-more="nextpage" class="wp-more-tag mce-wp-nextpage" alt="" title="'+n+'" data-mce-resize="false" data-mce-placeholder="1" />')),t.load&&"raw"!==t.format&&p&&(t.content=c.editor.autop(t.content)),-1===t.content.indexOf("<script")&&-1===t.content.indexOf("<style")||(t.content=t.content.replace(/<(script|style)[^>]*>[\s\S]*?<\/\1>/g,function(t,n){return'<img src="'+e.Env.transparentSrc+'" data-wp-preserve="'+encodeURIComponent(t)+'" data-mce-resize="false" data-mce-placeholder="1" class="mce-object" width="20" height="20" alt="&lt;'+n+'&gt;" title="&lt;'+n+'&gt;" />'})),t.content=t.content.replace(/<p>([^<>]+)<\/p>/gi,function(e,t){return"&nbsp;"!==t&&/\S/.test(t)?e:"<p><br /></p>"}))}),t.on("PostProcess",function(e){e.get&&(e.content=e.content.replace(/<img[^>]+>/g,function(e){var t,n,o="";return-1!==e.indexOf('data-wp-more="more"')?((t=e.match(/data-wp-more-text="([^"]+)"/))&&(o=t[1]),n="<!--more"+o+"-->"):-1!==e.indexOf('data-wp-more="nextpage"')?n="<!--nextpage-->":-1!==e.indexOf("data-wp-preserve")&&(t=e.match(/ data-wp-preserve="([^"]+)"/))&&(n=decodeURIComponent(t[1])),n||e}))}),t.on("ResolveName",function(e){var n;"IMG"===e.target.nodeName&&(n=t.dom.getAttrib(e.target,"data-wp-more"))&&(e.name=n)}),t.addCommand("WP_More",function(n){var o,i,a,r="wp-more-tag",s=t.dom,l=t.selection.getNode();return n=n||"more",r+=" mce-wp-"+n,a="more"===n?"Read more...":"Next page",a=d(a),i='<img src="'+e.Env.transparentSrc+'" alt="" title="'+a+'" class="'+r+'" data-wp-more="'+n+'" data-mce-resize="false" data-mce-placeholder="1" />',"BODY"===l.nodeName||"P"===l.nodeName&&"BODY"===l.parentNode.nodeName?void t.insertContent(i):void((o=s.getParent(l,function(e){return!(!e.parentNode||"BODY"!==e.parentNode.nodeName)},t.getBody()))&&("P"===o.nodeName?o.appendChild(s.create("p",null,i).firstChild):s.insertAfter(s.create("p",null,i),o),t.nodeChanged()))}),t.addCommand("WP_Code",function(){t.formatter.toggle("code")}),t.addCommand("WP_Page",function(){t.execCommand("WP_More","nextpage")}),t.addCommand("WP_Help",function(){function n(e,t){var n="<tr>",o=0;for(t=t||1,s(e,function(e,t){n+="<td><kbd>"+t+"</kbd></td><td>"+d(e)+"</td>",o++});o<t;)n+="<td></td><td></td>",o++;return n+"</tr>"}var o,i,a,r,l=d(e.Env.mac?"Ctrl + Alt + letter:":"Shift + Alt + letter:"),c=d(e.Env.mac?"Cmd + letter:":"Ctrl + letter:"),p=[],m=[],u={},g={},h=0,f=0,w=t.settings.wp_shortcut_labels;w&&(s(w,function(e,t){var o;-1!==e.indexOf("meta")?(h++,(o=e.replace("meta","").toLowerCase())&&(u[o]=t,h%2==0&&(p.push(n(u,2)),u={}))):-1!==e.indexOf("access")&&(f++,(o=e.replace("access","").toLowerCase())&&(g[o]=t,f%2==0&&(m.push(n(g,2)),g={})))}),h%2>0&&p.push(n(u,2)),f%2>0&&m.push(n(g,2)),o=[d("Letter"),d("Action"),d("Letter"),d("Action")],o="<tr><th>"+o.join("</th><th>")+"</th></tr>",i='<div class="wp-editor-help">',i=i+"<h2>"+d("Default shortcuts,")+" "+c+'</h2><table class="wp-help-th-center fixed">'+o+p.join("")+"</table><h2>"+d("Additional shortcuts,")+" "+l+'</h2><table class="wp-help-th-center fixed">'+o+m.join("")+"</table>",t.plugins.wptextpattern&&(!e.Env.ie||e.Env.ie>8)&&(i=i+"<h2>"+d("When starting a new paragraph with one of these formatting shortcuts followed by a space, the formatting will be applied automatically. Press Backspace or Escape to undo.")+'</h2><table class="wp-help-th-center fixed">'+n({"*":"Bullet list","1.":"Numbered list"})+n({"-":"Bullet list","1)":"Numbered list"})+"</table>",i=i+"<h2>"+d("The following formatting shortcuts are replaced when pressing Enter. Press Escape or the Undo button to undo.")+'</h2><table class="wp-help-single">'+n({">":"Blockquote"})+n({"##":"Heading 2"})+n({"###":"Heading 3"})+n({"####":"Heading 4"})+n({"#####":"Heading 5"})+n({"######":"Heading 6"})+n({"---":"Horizontal line"})+"</table>"),i=i+"<h2>"+d("Focus shortcuts:")+'</h2><table class="wp-help-single">'+n({"Alt + F8":"Inline toolbar (when an image, link or preview is selected)"})+n({"Alt + F9":"Editor menu (when enabled)"})+n({"Alt + F10":"Editor toolbar"})+n({"Alt + F11":"Elements path"})+"</table><p>"+d("To move focus to other buttons use Tab or the arrow keys. To return focus to the editor press Escape or use one of the buttons.")+"</p>",i+="</div>",a=t.windowManager.open({title:"Keyboard Shortcuts",items:{type:"container",classes:"wp-help",html:i},buttons:{text:"Close",onclick:"close"}}),a.$el&&(a.$el.find('div[role="application"]').attr("role","document"),r=a.$el.find(".mce-wp-help"),r[0]&&(r.attr("tabindex","0"),r[0].focus(),r.on("keydown",function(e){e.keyCode>=33&&e.keyCode<=40&&e.stopPropagation()}))))}),t.addCommand("WP_Medialib",function(){c&&c.media&&c.media.editor&&c.media.editor.open(t.id)}),t.addButton("wp_more",{tooltip:"Insert Read More tag",onclick:function(){t.execCommand("WP_More","more")}}),t.addButton("wp_page",{tooltip:"Page break",onclick:function(){t.execCommand("WP_More","nextpage")}}),t.addButton("wp_help",{tooltip:"Keyboard Shortcuts",cmd:"WP_Help"}),t.addButton("wp_code",{tooltip:"Code",cmd:"WP_Code",stateSelector:"code"}),c&&c.media&&c.media.editor&&t.addMenuItem("add_media",{text:"Add Media",icon:"wp-media-library",context:"insert",cmd:"WP_Medialib"}),t.addMenuItem("wp_more",{text:"Insert Read More tag",icon:"wp_more",context:"insert",onclick:function(){t.execCommand("WP_More","more")}}),t.addMenuItem("wp_page",{text:"Page break",icon:"wp_page",context:"insert",onclick:function(){t.execCommand("WP_More","nextpage")}}),t.on("BeforeExecCommand",function(n){!e.Env.webkit||"InsertUnorderedList"!==n.command&&"InsertOrderedList"!==n.command||(a||(a=t.dom.create("style",{type:"text/css"},"#tinymce,#tinymce span,#tinymce li,#tinymce li>span,#tinymce p,#tinymce p>span{font:medium sans-serif;color:#000;line-height:normal;}")),t.getDoc().head.appendChild(a))}),t.on("ExecCommand",function(n){e.Env.webkit&&a&&("InsertUnorderedList"===n.command||"InsertOrderedList"===n.command)&&t.dom.remove(a)}),t.on("init",function(){var n=e.Env,o=["mceContentBody"],i=t.getDoc(),a=t.dom;if(n.iOS&&a.addClass(i.documentElement,"ios"),"rtl"===t.getParam("directionality")&&(o.push("rtl"),a.setAttrib(i.documentElement,"dir","rtl")),a.setAttrib(i.documentElement,"lang",t.getParam("wp_lang_attr")),n.ie?9===parseInt(n.ie,10)?o.push("ie9"):8===parseInt(n.ie,10)?o.push("ie8"):n.ie<8&&o.push("ie7"):n.webkit&&o.push("webkit"),o.push("wp-editor"),s(o,function(e){e&&a.addClass(i.body,e)}),t.on("BeforeSetContent",function(e){e.content&&(e.content=e.content.replace(/<p>\s*<(p|div|ul|ol|dl|table|blockquote|h[1-6]|fieldset|pre)( [^>]*)?>/gi,"<$1$2>").replace(/<\/(p|div|ul|ol|dl|table|blockquote|h[1-6]|fieldset|pre)>\s*<\/p>/gi,"</$1>"))}),l&&l(document).triggerHandler("tinymce-editor-init",[t]),window.tinyMCEPreInit&&window.tinyMCEPreInit.dragDropUpload&&a.bind(i,"dragstart dragend dragover drop",function(e){l&&l(document).trigger(new l.Event(e))}),t.getParam("wp_paste_filters",!0)&&(t.on("PastePreProcess",function(t){t.content=t.content.replace(/<br class="?Apple-interchange-newline"?>/gi,""),e.Env.webkit||(t.content=t.content.replace(/(<[^>]+) style="[^"]*"([^>]*>)/gi,"$1$2"),t.content=t.content.replace(/(<[^>]+) data-mce-style=([^>]+>)/gi,"$1 style=$2"))}),t.on("PastePostProcess",function(e){s(a.select("p",e.node),function(e){a.isEmpty(e)&&a.remove(e)})})),t.settings.wp_shortcut_labels&&t.theme.panel){var r={},d="Shift+Alt+",c="Ctrl+";e.Env.mac&&(d="⌃⌥",c="⌘"),s(t.settings.wp_shortcut_labels,function(e,t){r[t]=e.replace("access",d).replace("meta",c)}),s(t.theme.panel.find("button"),function(e){e&&e.settings.tooltip&&r.hasOwnProperty(e.settings.tooltip)&&(e.settings.tooltip=t.translate(e.settings.tooltip)+" ("+r[e.settings.tooltip]+")")}),s(t.theme.panel.find("listbox"),function(e){e&&"Paragraph"===e.settings.text&&s(e.settings.values,function(e){e.text&&r.hasOwnProperty(e.text)&&(e.shortcut="("+r[e.text]+")")})})}}),t.on("SaveContent",function(e){return!t.inline&&t.isHidden()?void(e.content=e.element.value):(e.content=e.content.replace(/<p>(?:<br ?\/?>|\u00a0|\uFEFF| )*<\/p>/g,"<p>&nbsp;</p>"),void(p&&(e.content=c.editor.removep(e.content))))}),t.on("preInit",function(){var n="@[id|accesskey|class|dir|lang|style|tabindex|title|contenteditable|draggable|dropzone|hidden|spellcheck|translate],i,b,script[src|async|defer|type|charset|crossorigin|integrity]";t.schema.addValidElements("@[id|accesskey|class|dir|lang|style|tabindex|title|contenteditable|draggable|dropzone|hidden|spellcheck|translate],i,b,script[src|async|defer|type|charset|crossorigin|integrity]"),e.Env.iOS&&(t.settings.height=300),s({c:"JustifyCenter",r:"JustifyRight",l:"JustifyLeft",j:"JustifyFull",q:"mceBlockQuote",u:"InsertUnorderedList",o:"InsertOrderedList",m:"WP_Medialib",z:"WP_Adv",t:"WP_More",d:"Strikethrough",h:"WP_Help",p:"WP_Page",x:"WP_Code"},function(e,n){t.shortcuts.add("access+"+n,"",e)}),t.addShortcut("meta+s","",function(){c&&c.autosave&&c.autosave.server.triggerSave()}),window.getUserSetting("editor_plain_text_paste_warning")>1&&(t.settings.paste_plaintext_inform=!1),e.Env.mac&&e.$(t.iframeElement).attr("title",d("Rich Text Area. Press Control-Option-H for help."))}),t.on("PastePlainTextToggle",function(e){if(!0===e.state){var t=parseInt(window.getUserSetting("editor_plain_text_paste_warning"),10)||0;t<2&&window.setUserSetting("editor_plain_text_paste_warning",++t)}}),t.on("preinit",function(){function n(n,o){function i(){if(!a)return this;var t,n,o=window.pageXOffset||document.documentElement.scrollLeft,i=window.pageYOffset||document.documentElement.scrollTop,s=window.innerWidth,d=window.innerHeight,m=f?f.getBoundingClientRect():{top:0,right:s,bottom:d,left:0,width:s,height:d},u=this.getEl(),g=u.offsetWidth,w=u.clientHeight,b=a.getBoundingClientRect(),v=(b.left+b.right)/2,y=5,_=w+5,C=h?h.getBoundingClientRect().bottom:0,x=l?l.getBoundingClientRect().bottom:0,P=c?d-c.getBoundingClientRect().top:0,E=p?d-p.getBoundingClientRect().top:0,S=Math.max(0,C,x,m.top),k=Math.max(0,P,E,d-m.bottom),B=b.top+m.top-S,O=d-m.top-b.bottom-k,I=d-S-k,M="",W=0,z=0;return B>=I||O>=I?(this.scrolling=!0,this.hide(),this.scrolling=!1,this):(e.Env.iOS&&"IMG"===a.nodeName&&(W=54,z=46),this.bottom?O>=_?(M=" mce-arrow-up",t=b.bottom+m.top+i-z):B>=_&&(M=" mce-arrow-down",t=b.top+m.top+i-w+W):B>=_?(M=" mce-arrow-down",t=b.top+m.top+i-w+W):O>=_&&I/2>b.bottom+m.top-S&&(M=" mce-arrow-up",t=b.bottom+m.top+i-z),void 0===t&&(t=i+S+5+z),n=v-g/2+m.left+o,b.left<0||b.right>m.width?n=m.left+o+(m.width-g)/2:g>=s?(M+=" mce-arrow-full",n=0):n<0&&b.left+g>s||n+g>s&&b.right-g<0?n=(s-g)/2:n<m.left+o?(M+=" mce-arrow-left",n=b.left+m.left+o):n+g>m.width+m.left+o&&(M+=" mce-arrow-right",n=b.right-g+m.left+o),e.Env.iOS&&"IMG"===a.nodeName&&(M=M.replace(/ ?mce-arrow-(up|down)/g,"")),u.className=u.className.replace(/ ?mce-arrow-[\w]+/g,"")+M,r.setStyles(u,{left:n,top:t}),this)}var d,g,w=[];return s(n,function(e){function n(){var n=t.selection;"bullist"===o&&n.selectorChanged("ul > li",function(t,n){for(var o,i=n.parents.length;i--&&"OL"!==(o=n.parents[i].nodeName)&&"UL"!=o;);e.active(t&&"UL"===o)}),"numlist"===o&&n.selectorChanged("ol > li",function(t,n){for(var o,i=n.parents.length;i--&&"OL"!==(o=n.parents[i].nodeName)&&"UL"!==o;);e.active(t&&"OL"===o)}),e.settings.stateSelector&&n.selectorChanged(e.settings.stateSelector,function(t){e.active(t)},!0),e.settings.disabledStateSelector&&n.selectorChanged(e.settings.disabledStateSelector,function(t){e.disabled(t)})}var o;"|"===e?g=null:m.has(e)?(e={type:e},u.toolbar_items_size&&(e.size=u.toolbar_items_size),w.push(e),g=null):(g||(g={type:"buttongroup",items:[]},w.push(g)),t.buttons[e]&&(o=e,e=t.buttons[o],"function"==typeof e&&(e=e()),e.type=e.type||"button",u.toolbar_items_size&&(e.size=u.toolbar_items_size),e=m.create(e),g.items.push(e),t.initialized?n():t.on("init",n)))}),d=m.create({type:"panel",layout:"stack",classes:"toolbar-grp inline-toolbar-grp",ariaRoot:!0,ariaRemember:!0,items:[{type:"toolbar",layout:"flow",items:w}]}),d.bottom=o,d.on("show",function(){this.reposition()}),d.on("keydown",function(e){27===e.keyCode&&(this.hide(),t.focus())}),t.on("remove",function(){d.remove()}),d.reposition=i,d.hide().renderTo(document.body),d}function o(e){i&&(i.tempHide||"hide"===e.type||"blur"===e.type?(i.hide(),i=!1):"resizewindow"!==e.type&&"scrollwindow"!==e.type&&"resize"!==e.type&&"scroll"!==e.type||i.blockHide||(clearTimeout(d),d=setTimeout(function(){i&&"function"==typeof i.show&&(i.scrolling=!1,i.show())},250),i.scrolling=!0,i.hide()))}var i,a,d,l,c,p,m=e.ui.Factory,u=t.settings,g=t.getContainer(),h=document.getElementById("wpadminbar"),f=document.getElementById(t.id+"_ifr");g&&(l=e.$(".mce-toolbar-grp",g)[0],c=e.$(".mce-statusbar",g)[0]),"content"===t.id&&(p=document.getElementById("post-status-info")),t.shortcuts.add("alt+119","",function(){var e;i&&(e=i.find("toolbar")[0])&&e.focus(!0)}),t.on("nodechange",function(e){var n=t.selection.isCollapsed(),o={element:e.element,parents:e.parents,collapsed:n};t.fire("wptoolbar",o),a=o.selection||o.element,i&&i!==o.toolbar&&i.hide(),o.toolbar?i!==o.toolbar?(i=o.toolbar,i.show()):i.reposition():i=!1}),t.on("focus",function(){i&&i.show()}),t.on("resizewindow scrollwindow",o),t.dom.bind(t.getWin(),"resize scroll",o),t.on("remove",function(){t.off("resizewindow scrollwindow",o),t.dom.unbind(t.getWin(),"resize scroll",o)}),t.on("blur hide",o),t.wp=t.wp||{},t.wp._createToolbar=n},!0),{_showButtons:o,_hideButtons:o,_setEmbed:o,_getEmbed:o}})}(window.tinymce);